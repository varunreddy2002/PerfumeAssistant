<!-- templates/prompt.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Perfume Recommender</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='prompt_style.css') }}" />
</head>
<body class="prompt-page">
  <button type="button" id="backButton" class="send-button" aria-label="Back">Back</button>

  <div class="container">
    <h2>Welcome, {{ username }}!</h2>
    <form method="post" id="prompt-form">
      <textarea
        name="user_input"
        placeholder="EX: Find a subtle perfume..."
        required
      ></textarea>

      <button type="submit" aria-label="Submit" id="sendButton">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3"
          stroke-linecap="round" stroke-linejoin="round">
          <line x1="12" y1="19" x2="12" y2="5"></line>
          <polyline points="5 12 12 5 19 12"></polyline>
        </svg>
      </button>
    </form>
  </div>

  <div class="loading-overlay" id="loadingOverlay" style="display: none;">
    <div class="perfume-animation"><div class="loading-overlay" id="loadingOverlay" style="display: none;">
  <div class="perfume-animation">
    <svg width="120" height="300" viewBox="0 0 120 300" xmlns="http://www.w3.org/2000/svg">
      <!-- Bottle base -->
      <rect x="35" y="100" width="50" height="150" rx="25" ry="25" fill="#d4a373" stroke="#8b5e3c" stroke-width="3"/>
      <!-- Bottle cap -->
      <rect x="45" y="80" width="30" height="20" rx="5" ry="5" fill="#555" />
      <!-- Spray nozzle -->
      <circle cx="60" cy="80" r="4" fill="#fff" />
      <!-- Spray mist -->
      <g id="sprayMist">
        <circle class="mistParticle" cx="60" cy="80" r="2" fill="#cce5ff"/>
        <circle class="mistParticle" cx="62" cy="78" r="1.5" fill="#cce5ff"/>
        <circle class="mistParticle" cx="58" cy="78" r="1.5" fill="#cce5ff"/>
        <circle class="mistParticle" cx="61" cy="76" r="1.2" fill="#cce5ff"/>
        <circle class="mistParticle" cx="59" cy="76" r="1.2" fill="#cce5ff"/>
      </g>
    </svg>
  </div>
  <span>Scentify is brewing your match...</span>
</div>
</div>
    <span>Scentify is brewing your match...</span>
  </div>

  <script>
    document.getElementById('backButton').onclick = () => {
      window.location.href = "{{ url_for('login') }}";
    };
    const form = document.getElementById('prompt-form');
    const loadingOverlay = document.getElementById('loadingOverlay');
    form.addEventListener('submit', () => {
      form.querySelector("button[type='submit']").disabled = true;
      loadingOverlay.style.display = 'flex';
      document.getElementById('backButton').style.display = 'none';
    });
  </script>
</body>
</html>
